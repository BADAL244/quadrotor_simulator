function [r, A] = give_matrix(t,S,T, k, mode)
a = (t-S)/T;
if strcmp(mode,'snap')
    A = [1 a a^2 a^3 a^4 a^5 a^6 a^7;
        0 1/T 2*a/T 3*a^2/T 4*a^3/T 5*a^4/T 6*a^5/T 7*a^6/T;
        0 0 2/T^2 3*2*a/T^2 4*3*a^2/T^2 5*4*a^3/T^2 6*5*a^4/T^2 7*6*a^5/T^2;
        0 0 0 6/T^3 4*3*2*a/T^3 5*4*3*a^2/T^3 6*5*4*a^3/T^3 7*6*5*a^4/T^3;
        0 0 0 0 24/T^4 5*4*3*2*a/T^4 6*5*4*3*a^2/T^4 7*6*5*4*a^3/T^4;
        0 0 0 0 0 120/T^5 6*5*4*3*2*a/T^5 7*6*5*4*3*a^2/T^5;
        0 0 0 0 0 0 720/T^6 7*6*5*4*3*2*a/T^6];
    
elseif strcmp(mode,'jerk')
    A = [1 a a^2 a^3 a^4 a^5;
        0 1/T 2*a/T 3*a^2/T 4*a^3/T 5*a^4/T;
        0 0 2/T^2 3*2*a/T^2 4*3*a^2/T^2 5*4*a^3/T^2;
        0 0 0 6/T^3 4*3*2*a/T^3 5*4*3*a^2/T^3;
        0 0 0 0 24/T^4 5*4*3*2*a/T^4];
    
elseif strcmp(mode,'acc')
    A = [1 a a^2 a^3;
        0 1/T 2*a/T 3*a^2/T;
        0 0 2/T^2 3*2*a/T^2];
    
end
r = A(k,:);
end